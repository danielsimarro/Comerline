<?php
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
$cookieManager = $objectManager->get('Magento\Framework\Stdlib\CookieManagerInterface');
$cookie = $cookieManager->getCookie('llantas_user_car');
$category = null;
$validVariations = null;
$comparableAttributes = ['diameter', 'width', 'offset', 'hub'];
$blockData = $block->getData();
if (array_key_exists('data', $blockData)) {
    $validVariations = $blockData['data']['validVariations'];
}
if ($cookie) :
    $category = $block->getCategoryById($cookie);
endif;
?>

<div id="compatible-rims">
    <?php
if ($category && $validVariations):
                ?>
                <p id="green"> <?php echo __('Esta llanta es compatible con tu vehículo') ?> </p>
                <?php
                ?>
                <div id="compatible">
                    <table id="compatible-table">
                        <tr>
                            <th><?php echo __('Diametro') ?></th>
                            <th><?php echo __('Ancho') ?></th>
                            <th><?php echo __('ET') ?></th>
                            <th><?php echo __('Buje') ?></th>
                        </tr>
                        <?php
                        foreach ($validVariations as $variation) {
                            ?>
                            <tr>
                                <?php
                                $variationAttributes = explode(',', substr($variation, 0, strlen($variation) - 1));
                                for ($i = 0; $i < count($variationAttributes); $i++) {
                                    ?>
                                    <th id="attribute-option" attribute-text="<?php echo $comparableAttributes[$i] ?>"
                                        attribute-id="<?php echo $block->getAttributeId($comparableAttributes[$i], $variationAttributes[$i]) ?>"><?php echo $variationAttributes[$i] ?></th>
                                    <?php
                                }
                                ?>
                            </tr>
                            <?php
                        }
                        ?>
                    </table>
                </div>
</div>
<?php
else:
    ?>
    <p id="red"> <?php echo __('Esta llanta no tiene variaciones compatibles con tu vehículo') ?> </p>
</div>
<?php
endif;
?>

<script>
    require(['jquery', 'showModal'], function ($, showModal) {
        showModal();
    });
</script>
